/* ============================================================
   ЁЯй║ ShriVidya рд╢реБрджреНрдзтАУрд╡рд╛рдгреА Live Quiz System
   Doctor Voice Enhancement & Sync Tune тАФ v6.0AтАвR┬╖Tune
   ------------------------------------------------------------
   рдЙрджреНрджреЗрд╢реНрдп: рдЖрд╡рд╛рдЬрд╝ рдХреЛ рдорд╛рдирд╡реАрдп, рднрд╛рд╡рдирд╛рддреНрдордХ рдФрд░ рд╕рдордиреНрд╡рд┐рдд рдмрдирд╛рдирд╛
   ------------------------------------------------------------
   тЬЕ рдореБрдЦреНрдп рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ:
      тАв Human-Like Emotional Pause System
      тАв Breath Interval Sync (~0.9s)
      тАв VoiceтАУPetal Rhythm Harmony
      тАв Real-Time Warm Tone Enhancement
   ============================================================ */

// ЁЯМ╣ рдкрдВрдЦреБрдбрд╝реА рдПрдиреАрдореЗрд╢рди рдмрдирд╛рдирд╛
function createPetal() {
  const petal = document.createElement("div");
  petal.classList.add("petal");
  petal.style.left = Math.random() * 100 + "vw";
  petal.style.animationDuration = 3 + Math.random() * 5 + "s";
  document.body.appendChild(petal);
  setTimeout(() => petal.remove(), 8000);
}
setInterval(createPetal, 400);

// ЁЯй║ рдкреНрд░рд╢рд╕реНрддрд┐ рд╕рдВрджреЗрд╢
const message = `рд╢реНрд░реАрд╡рд┐рджреНрдпрд╛ рдкреНрд░реЛрддреНрд╕рд╛рд╣рд┐рдд рдХрд░ рд░рд╣реА рд╣реИрдВ тАФ
рдХрд┐ рдЖрдк рдкреНрд░рддрд┐рдпреЛрдЧреА рдкрд░реАрдХреНрд╖рд╛рдУрдВ рдХреА рддреИрдпрд╛рд░реА
рдЕрдкрдиреЗ рдХреАрдорддреА рд╕рдордп рдореЗрдВ рдХрд░реЗрдВред

рдмрд╣реБрдд рд╕реЗ рдкреНрд░рддрд┐рднрд╛рд╢рд╛рд▓реА рд╡рд┐рджреНрдпрд╛рд░реНрдереА рдХреЗрд╡рд▓
рд╕рд╣реА рдорд╛рд░реНрдЧрджрд░реНрд╢рди рдХреЗ рдЕрднрд╛рд╡ рдореЗрдВ рдЕрд╡рд╕рд░реЛрдВ рд╕реЗ рд╡рдВрдЪрд┐рдд рд░рд╣ рдЬрд╛рддреЗ рд╣реИрдВред

рдпрджрд┐ рдЖрдк рдпрд╣ рддреИрдпрд╛рд░реА рдХрд░рддреЗ рд╣реИрдВ тАФ
рддреЛ рдЖрдк рдЙрди рд╕рднреА рдХреЗ рд▓рд┐рдП рдкреНрд░реЗрд░рдгрд╛ рдмрди рд╕рдХрддреЗ рд╣реИрдВ,
рдЬрд┐рдирдХреЗ рдкрд╛рд╕ рдЗрдЪреНрдЫрд╛рд╢рдХреНрддрд┐ рд╣реИ рдкрд░ рджрд┐рд╢рд╛ рдирд╣реАрдВред

рд╢рд┐рдХреНрд╖рд╛ рдХрд╛ рдкреНрд░рдХрд╛рд╢ рддрднреА рдкреВрд░реНрдг рд╣реЛрддрд╛ рд╣реИ
рдЬрдм рд╡рд╣ рдХрд┐рд╕реА рдФрд░ рдХреЗ рдЬреАрд╡рди рдХреЛ рдЖрд▓реЛрдХрд┐рдд рдХрд░реЗред`;

const textBox = document.getElementById("appreciation-text");
let idx = 0;

// тЬи рдЪрд▓рддреА рд╣реБрдИ рдкрдВрдХреНрддрд┐рдпрд╛рдБ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдирд╛
function typeText() {
  if (idx < message.length) {
    textBox.innerHTML += message.charAt(idx);
    idx++;
    setTimeout(typeText, 55);
  }
}
window.onload = typeText;

// ЁЯФИ рдкреНрд░рд╛рдХреГрддрд┐рдХ рдбреЙрдХреНрдЯрд░ рд╡реЙрдпрд╕ (Emotion Sync)
function playDoctorVoice() {
  if (!("speechSynthesis" in window)) {
    alert("тЪая╕П рдЖрдкрдХрд╛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЖрд╡рд╛рдЬрд╝ рд╕рдкреЛрд░реНрдЯ рдирд╣реАрдВ рдХрд░рддрд╛ред");
    return;
  }

  const sentences = message.split(/\n+/).filter((s) => s.trim() !== "");
  let i = 0;

  function speakNext() {
    if (i >= sentences.length) return;

    const msg = new SpeechSynthesisUtterance(sentences[i]);
    msg.lang = "hi-IN";
    msg.rate = 0.87; // рдзреАрдореА, рдЧрд░реНрдо рдЖрд╡рд╛рдЬрд╝
    msg.pitch = 0.91; // рдбреЙрдХреНрдЯрд░ рдЬреИрд╕реА рдЧрд╣рд░рд╛рдИ
    msg.volume = 1.0;
    msg.voice = speechSynthesis
      .getVoices()
      .find((v) => v.lang === "hi-IN") || null;

    // ЁЯМ╕ рд╣рд░ рд╡рд╛рдХреНрдп рдкрд░ рдПрдиреАрдореЗрд╢рди рд╕реЙрдлреНрдЯ рдХрд░ рджреЗрдирд╛
    document.querySelectorAll(".petal").forEach((p) => {
      p.style.opacity = "0.9";
      p.style.transition = "opacity 1s";
    });

    msg.onend = () => {
      setTimeout(() => {
        i++;
        speakNext();
      }, 900); // 0.9 рд╕реЗрдХрдВрдб рдорд╛рдирд╡реАрдп рд╡рд┐рд░рд╛рдо
    };

    speechSynthesis.speak(msg);
  }

  speakNext();
}

// ЁЯОм MP4 рдбрд╛рдЙрдирд▓реЛрдб (рдЕрднреА рдмреАрдЯрд╛ рдореЗрдВ)
function downloadAppreciationMP4() {
  alert("ЁЯОЮя╕П MP4 рдбрд╛рдЙрдирд▓реЛрдб рдлреАрдЪрд░ рдмреАрдЯрд╛ рдореЗрдВ рд╣реИ тАФ Desktop Chrome рдкрд░ рд╢реНрд░реЗрд╖реНрда рдкреНрд░рджрд░реНрд╢рди рджреЗрддрд╛ рд╣реИред");
}
